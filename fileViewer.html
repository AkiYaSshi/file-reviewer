<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>解壓縮肝麻店</title>
    <link rel=" stylesheet" href="style.css" />
    <!--google抓來的icon-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

</head>
<body oncontextmenu="return false;">
    <div class="navigation-overlay" id= "helpBar"  onclick="toggleVis('helpBar')">
        <div class="overlay-text">
            <h3 style="margin: 25vh 6vw;">
                <span class="material-symbols-outlined">
                    arrow_left_alt
                </span>可查看各類作品
            </h3>
            <h3 style="margin: 30vh 80vw;">
                <span class="material-symbols-outlined">
                    arrow_left_alt
                </span>左鍵可觀看影片或開啟遊戲
                <br />右鍵可放大圖像
            </h3>
        </div>
    </div>
    <aside class="sidebar">
        <div class="sidebar-background">
            <div class="sidebar-header">
                <span class="material-symbols-outlined">
                    menu
                </span>
                <h2>解壓縮肝麻店</h2>
            </div>
            <ul class="sidebar-links">
                <h4>作品分類</h4>
                <li>
                    <a href="#video-container">
                        <span class="material-symbols-outlined">
                            movie
                        </span>動畫藝術類
                    </a>
                </li>
                <li>
                    <a href="#game-container">
                        <span class="material-symbols-outlined">
                            stadia_controller
                        </span>多媒體設計類
                    </a>
                </li>
                <li>
                    <a href="#media-container">
                        <span class="material-symbols-outlined">
                            head_mounted_device
                        </span>新媒體藝術類
                    </a>
                </li>
            </ul>
        </div>
    </aside>
    <div class="top-bar">

    </div>

    <div class="video-container" id="video-container">
        <h1>動畫藝術類</h1>
    </div>
    <div class="game-container" id="game-container">
        <h1>多媒體設計類</h1>
    </div>
    <div class="media-container" id="media-container">
        <h1>新媒體藝術類</h1>
    </div>


    <div class="help-bar">
        <div class="help-button" onclick="toggleVis('helpBar')">
            <span class="material-symbols-outlined">
                <img src="UI/0-11.png" width="50"/>
                question_mark
            </span>

        </div>
    </div>
    <script>
        let videos = [], games = [], medias = [];
        let nowContainer;

        const videoContainer = document.getElementById("video-container");
        const gameContainer = document.getElementById("game-container");
        const mediaContainer = document.getElementById("media-container");

        const title = document.getElementById("title");

        nowContainer = videoContainer;
        fetch('https://raw.githubusercontent.com/AkiYaSshi/file-reviewer/master/works.json')
            .then(response => {
                if (!response.ok) {

                }
                return response.json();
            })
            .then(data => {
                videos = data.videos;
                games = data.games;
                medias = data.medias;
                createWorks(videos, videoContainer, "video_");
                createWorks(games, gameContainer, "game_");
                createWorks(medias, mediaContainer, "media_");

                window.location.hash = (window.location.hash == "") ? '#video-container' : window.location.hash;
            })
            .catch(error => {
                console.error("載入 JSON 失敗：", error);
                title.textContent = "載入失敗";
                nowContainer.innerHTML = "<p style='color:grey;'>無法載入作品資料</br>請聯繫網站程式</p>";
            });
        // 動態生成影片卡片

        function createWorks(type, container, name) {

            type.forEach((work, index) => {
                const card = document.createElement("div");
                card.className = "work-card";


                if (type == games) {
                    card.innerHTML = `
                                                            <div class = "description" title = "開啟遊戲檔案位置" onclick = "window.open('${work.path}');">
                                                                <h2>${work.title}</h2>
                                                                <p>${work.description}</p>
                                                            </div>
                                                            <img  width="480" height="270" id="${name}${index}" src="${work.src}" frameborder="0" scrolling="no" allowfullscreen ></iframe>
                                                    `;
                }
                else {
                    card.innerHTML = `
                                                                 <a href="${work.url}" target = "_blank" title = "觀看影片">
                                                                     <div class = "description">
                                                                        <h2>${work.title}</h2>
                                                                        <p>${work.description}</p>
                                                                    </div>
                                                                    <img  width="480" height="270" id="${name}${index}" src="${work.cover}" frameborder="0" scrolling="no" allowfullscreen ></iframe>
                                                                </a>

                                                                `;
                }
                card.addEventListener("mousedown", (e) => {
                    if (e.button == 2) {
                        goFullscreen(name, index);
                    }
                });
                container.appendChild(card);
            });
        }

        function goFullscreen(work, index) {
            const video = document.getElementById(`${work}${index}`);

            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.webkitRequestFullscreen) {
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) {
                video.msRequestFullscreen();
            }
        }
        function toggleVis(target) {
            const obj = document.getElementById(target);
            if (obj.style.display == 'none') {
                obj.style.display = 'flex';
            }
            else {
                obj.style.display = 'none';
            }
        }
    </script>
</body>
</html>