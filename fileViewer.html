<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>解壓縮肝麻店</title>
    <link rel=" stylesheet" href="style.css" />
    <!--google抓來的icon-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <span class="material-symbols-outlined">
                menu
            </span>
            <h2>解壓縮肝麻店</h2>
        </div>
        <ul class="sidebar-links">
            <h4>作品分類</h4>
            <li>
                <button onclick="createVideo(videos, '動畫藝術類')">
                    <a href="#">
                        <span class="material-symbols-outlined">
                            movie
                        </span>動畫藝術類
                    </a>
                </button>
            </li>
            <li>
                <button onclick="createFile()">
                    <a href="#">
                        <span class="material-symbols-outlined">
                            stadia_controller
                        </span>多媒體設計類
                    </a>
                </button>
            </li>
            <li>
                <button onclick="createVideo(medias, '新媒體藝術類')">
                    <a href="#">
                        <span class="material-symbols-outlined">
                            head_mounted_device
                        </span>新媒體藝術類
                    </a>
                </button>
            </li>
        </ul>
    </aside>
    <div class="top-bar">
        <h1 id="title"></h1>
    </div>
    <div class="video-container" id="container"></div>
    </div>
    <script>
        let videos = [], games = [], medias = [];
        const container = document.getElementById("container");
        const title = document.getElementById("title");
        fetch('https://raw.githubusercontent.com/AkiYaSshi/file-reviewer/master/works.json')
            .then(response => {
                if (!response.ok) {

                }
                return response.json();
            })
            .then(data => {
                videos = data.videos;
                games = data.games;
                medias = data.medias;
                createVideo(videos, "動畫藝術類");

            })
            .catch(error => {
                console.error("載入 JSON 失敗：", error);
                title.textContent = "載入失敗";
                container.innerHTML = "<p style='color:grey;'>無法載入作品資料</br>請工作人員聯繫網站程式</p>";
            });
        // 動態生成影片卡片

        function createVideo(type, newtitle) {
            clear();
            title.textContent = newtitle;
            type.forEach((video, index) => {
                const card = document.createElement("div");
                card.className = "video-card";

                const newUrl = video.url.replace('youtube', 'youtube-nocookie');
                card.innerHTML = `
                                                <div class = "description">
                                                    <h2>${video.title}</h2>
                                                    <p>${video.description}</p>
                                                </div>
                                                <iframe width = "480" height = "270" id="video${index}" src="${newUrl}"title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen style = "border-radius: 10px"></iframe>
                                                `;
                container.appendChild(card);
            });
            document.querySelectorAll(".description").forEach((overlay, index) => {
                overlay.onclick = () => goFullscreen(index);
            });

            document.addEventListener("fullscreenchange", () => {
                if (!document.fullscreenElement) {
                    document.querySelectorAll("video").forEach(v => v.pause());
                }
            });
        }
        function createFile() {
            clear();
            title.textContent = "多媒體設計類";
            games.forEach((game, index) => {
                const card = document.createElement("div");
                card.className = "game-card";

                card.innerHTML = `
                                            <div class = "description" onclick = "window.open('${game.path}');">
                                                <h2>${game.title}</h2>
                                                <p>${game.description}</p>
                                            </div>
                                            <iframe  width="480" height="270" id="game${index}" src="${game.src}" frameborder="0" scrolling="no" allowfullscreen ></iframe>
                                    `;
                container.appendChild(card);
            });
        }


        function goFullscreen(index) {
            const video = document.getElementById(`video${index}`);
            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.webkitRequestFullscreen) {
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) {
                video.msRequestFullscreen();
            }
        }
        function clear() {
            const container = document.getElementById("container");
            container.innerHTML = null;
        }
    </script>
</body>
</html>